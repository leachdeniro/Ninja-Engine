/*Propiedades sprite de pruebawidth = 196height = 168widthFrame = 28heightFrame = 42 */function CharacterNew(src, x, y, z, widthFrame, heightFrame, numRows, numColums, velocity, xsd, ysd, widthStage, heightStage, widthCh, heightCh, update){   // Constructor de la clase padre   Entity.call(this, x, y, z, update);   this.xInit = x;   this.yInit = y;   this.image = new Image();   this.image.src = src;   this.widthFrame = widthFrame;   this.heightFrame = heightFrame;   this.numRows = numRows;   this.numColums = numColums;   // posición inicial   this.xPositionOnSprite = 0;   this.yPositionOnSprite = 84;   // variables para controlar velocidad del personaje   this.velocityFactor = velocity;   this.velocity = velocity;   // máximos del Sprite   this.maxWitdhtSprite = widthFrame * numColums - widthFrame;   this.maxHeighttSprite = heightFrame * numRows - heightFrame;   // m‡ximos ancho y alto   this.maxWStage = widthStage - widthFrame;   this.maxWStage = this.maxWStage % xsd == 0 ? this.maxWStage : this.maxWStage - (this.maxWStage % xsd);   this.maxHStage = heightStage - heightFrame;   this.maxHStage = this.maxHStage % ysd == 0 ? this.maxHStage : this.maxHStage - (this.maxHStage % ysd);   // valor desplazamiento de los ejex x y x para el personaje   this.xsd = xsd;   this.ysd = ysd;   // Ancho y alto del personaje a pintar. Independiente del tamaño de la imagen   this.widthCh = widthCh;   this.heightCh = heightCh;   this.draw = function (context)   {      context.drawImage(this.image, this.xPositionOnSprite, this.yPositionOnSprite, this.widthFrame, this.heightFrame, this.x, this.y, this.widthCh, this.heightCh);      this.drawCoordinates(context);   }   this.update = function ()   {      this.move(direction_scrolling);   }   /* se desplaza por una imagen   */   this.move = function(action)   {      switch (action)      {         case NORTH :            this.animationSprite();            this.yPositionOnSprite = 42;            break;         case EAST :            this.animationSprite();            this.yPositionOnSprite = 84;            break;         case SOUTH :            this.animationSprite();            this.yPositionOnSprite = 0;            break;         case WEST :            this.animationSprite();            this.yPositionOnSprite = 126;            break;         default :            break;      }      if (limitStageX !== NONE || limitStageY !== NONE)      {         if ((action == EAST || action == WEST) && limitStageX !== NONE)         {            this.advance(action);            if (this.x == this.xInit)            {               limitStageX = NONE;            }         }         if ((action == NORTH || action == SOUTH) && limitStageY !== NONE)         {            this.advance(action);            if (this.y == this.yInit)            {               limitStageY = NONE;            }         }      }   }   this.animationSprite = function()   {      if (this.velocityFactor % this.velocity == 0)      {         if ((this.xPositionOnSprite + this.widthFrame) <= (this.maxWitdhtSprite))         {            this.xPositionOnSprite += this.widthFrame;         }         else         {            this.xPositionOnSprite = 0;         }         this.velocityFactor = 1;      }      else      {         this.velocityFactor += 1;      }   }   this.advance = function(direction)   {      switch (direction)      {         case NORTH :         if ((this.y - this.ysd) >= 0)         {            this.y -= this.ysd;         }         else         {            this.y = 0;         }         break;         case EAST :         if ((this.x + this.xsd) <= (this.maxWStage - this.xsd))         {            this.x += this.ysd;         }         else         {            this.x = this.maxWStage;         }         break;         case SOUTH :         if ((this.y + this.ysd) <= (this.maxHStage - this.ysd))         {            this.y += this.ysd;         }         else         {            this.y = this.maxHStage;         }         break;         case WEST :         if ((this.x - this.xsd) >= 0)         {            this.x -= this.xsd;         }         else         {            this.x = 0;         }         break;         default :         break;      }   }   this.drawCoordinates = function (context)   {      context.save();      context.fillStyle = 'rgb(255,255,255)';      context.font = 'bold 10px sans-serif';      context.fillText('x,y/lX,lY: ' + this.x + ',' + this.y + '/' + limitStageX + ',' + limitStageY, 10, 25);      context.restore();   }}// Extiendo de EntityCharacter.prototype = new Entity();//Clases para manejo de Sprites con ancho y alto variable en sus accciones y framefunction FrameSprite(x,y,width,height,widthDraw,heightDraw){    this.x = x;    this.y = y;    this.width = width;    this.height = height;    this.widthDraw = widthDraw;    this.heightDraw = heightDraw;}function SpriteAction(){    //Arreglo de FrameSprite    this.sprites = new Array();        this.addFrame =  function (frameS){		this.sprites.push(frameS);	}		this.getFrame(position){	   this.sprites[position];	}}/*Ejemplo definición de la propiedad sprite en la clase Character.Arreglo de acciones del personajeElementos del arreglo    WALK_NORTH = 0,WALK_EAST =1,WALK_SOUTH =2 y WALK_WEST =4    Valores indicar el eje "y" del Sprite*//*Propiedades sprite de pruebawidth = 196height = 168widthFrame = 28heightFrame = 42 *//*var spriteWalkNorth = new SpriteAction();spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(28,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));spriteArray.addFrame(new FrameSprite(0,0,28,42,48,62));var spriteWalkEast = new SpriteAction();spriteArray.addFrame(new FrameSprite());var spriteActions = [spriteWalkNorth,spriteWalkEast];*/